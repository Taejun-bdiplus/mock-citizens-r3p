[
    {
        "enterprise": [
            {
                "enterprise_id": 3,
                "enterprise_type_id": 1,
                "enterprise_name": "FHLMC",
                "description": "Freddie Mac"
            },
            {
                "enterprise_id": 4,
                "enterprise_type_id": 1,
                "enterprise_name": "FNMA",
                "description": "Fannie Mae"
            },
            {
                "enterprise_id": 5,
                "enterprise_type_id": 1,
                "enterprise_name": "FHA/HUD",
                "description": "Federal Hounsing Administration"
            },
            {
                "enterprise_id": 6,
                "enterprise_type_id": 1,
                "enterprise_name": "VA",
                "description": "Veteran Affairs"
            }
        ],
        "contextResponse": [
            {
                "reviewTypeResponseDtos": [
                    {
                        "review_type_id": 12,
                        "review_type_name": "CPL",
                        "context_id": 8,
                        "description": "Compliance"
                    }
                ],
                "context_id": 8,
                "context_name": "FFR",
                "enterprise_type_id": 1,
                "description": "Full File Review"
            },
            {
                "reviewTypeResponseDtos": [],
                "context_id": 9,
                "context_name": "QA Audit",
                "enterprise_type_id": 1,
                "description": "QA Audit"
            },
            {
                "reviewTypeResponseDtos": [
                    {
                        "review_type_id": 13,
                        "review_type_name": "CPL/PL",
                        "context_id": 10,
                        "description": "Dual Review for both Compliance & Performing"
                    },
                    {
                        "review_type_id": 14,
                        "review_type_name": "DCCR",
                        "context_id": 10,
                        "description": "Dual Compliance Credit Review"
                    }
                ],
                "context_id": 10,
                "context_name": "Repurchase",
                "enterprise_type_id": 1,
                "description": "Repurchase"
            },
            {
                "reviewTypeResponseDtos": [
                    {
                        "review_type_id": 15,
                        "review_type_name": "DPPR",
                        "context_id": 11,
                        "description": "Discretionary Post Purchase Review"
                    },
                    {
                        "review_type_id": 16,
                        "review_type_name": "EPD",
                        "context_id": 11,
                        "description": "Early Payment Default Review"
                    },
                    {
                        "review_type_id": 17,
                        "review_type_name": "LOS",
                        "context_id": 11,
                        "description": "Loss Mitigation Review"
                    }
                ],
                "context_id": 11,
                "context_name": "MI FFR",
                "enterprise_type_id": 1,
                "description": "Mortgage Insurer Full File Review"
            }
        ],
        "enterprise_type_id": 1,
        "enterprise_type_name": "GSE",
        "description": "Government Sponsored Enterprise"
    },
    {
        "enterprise": [
            {
                "enterprise_id": 7,
                "enterprise_type_id": 2,
                "enterprise_name": "Essent",
                "description": "Essent"
            }
        ],
        "contextResponse": [],
        "enterprise_type_id": 2,
        "enterprise_type_name": "GA",
        "description": "Government Agency"
    }
]






/*

{

    "loan_number": "string",

    "requester_ent_id": 0,

    "requester_loan_number": "string",

    "responsible_ent_id": 0,

    "requester_ent_loan_number": "string",

    "context_id": 0,

    "channel_id": 0,

    "task_name": "string",

    "document_type": "string",

    "received_date": "2023-07-17T08:39:01.129Z",

    "loan_due_date": "2023-07-17T08:39:01.129Z",

    "loan_status": "string",

    "comments": "string",

    "colleague_id":123

}

https://r3p.p2.ocp.citizensbank.com/r3p-pipeline/review

 

Post method

*/


// chrome.exe --user-data-dir="C:\Users\N119807\\chrome-dev-disabled-security" --disable-web-security --disable-site-isolation-trials




// Sample Response [
//     {
//         "colleague_id": 1,
//         "colleague_fullname": "Rajat K",
//         "email": "rajatkesarwani2011@gmail.com",
//         "phone": "+91-1234567889",
//         "manager_id": 0,
//         "active": 1,
//         "no_of_assignment": 1,
//         "role_name": "Analyst",
//         "role_id": "2"
//     }
// ]

// API URL: https://r3p.p2.ocp.citizensbank.com/r3p-pipeline/colleague

// Method: GET

// Colleague API for the Select Analyst 



[
    {
        "colleague_id": 1,
        "colleague_fullname": "Hrishikesh Trivedi",
        "email": "hrishikesh.trivedi@citizensbank.com",
        "phone": "+919825949629",
        "manager_id": 0,
        "active": 1,
        "no_of_assignment": 0,
        "role_name": null,
        "role_id": 0
    },
    {
        "colleague_id": 2,
        "colleague_fullname": "Sandra H Butler",
        "email": "sandra.h.butler@citizensbank.com",
        "phone": "+19046143439",
        "manager_id": 1,
        "active": 1,
        "no_of_assignment": 0,
        "role_name": null,
        "role_id": 0
    },
    {
        "colleague_id": 3,
        "colleague_fullname": "Satish U",
        "email": "satish.u@citizensbank.com",
        "phone": "+918618679950",
        "manager_id": 0,
        "active": 1,
        "no_of_assignment": 0,
        "role_name": null,
        "role_id": 0
    },
    {
        "colleague_id": 4,
        "colleague_fullname": "Rajat Kesarvani",
        "email": "rajat.kesarwani@citizensbank.com",
        "phone": "+919310145625",
        "manager_id": 0,
        "active": 1,
        "no_of_assignment": 0,
        "role_name": null,
        "role_id": 0
    },
    {
        "colleague_id": 5,
        "colleague_fullname": "Pushpa Latha B",
        "email": "pushpalatha.b@citizensbank.com",
        "phone": "+919901273776",
        "manager_id": 0,
        "active": 0,
        "no_of_assignment": 0,
        "role_name": null,
        "role_id": 0
    }
]












/////////////////////////////////////////////////////////////////////////////////////////////////

import { Component, ViewChild } from '@angular/core';
import { MatDialog } from '@angular/material/dialog';
import { SelectAnalystUploadComponent } from '../select-analyst-upload/select-analyst-upload.component';
import { DataService } from 'src/app/data.service';

@Component({
  selector: 'app-add-manually-dialog',
  templateUrl: './add-manually-dialog.component.html',
  styleUrls: ['./add-manually-dialog.component.css']
})
export class AddManuallyDialogComponent {
  assignedAnalyst: string = '';
  selectedAnalystId: number = 0; // Property to store selected analyst's colleague_id
  
  constructor(private dialog: MatDialog, private dataService: DataService) {}

  openAssignDialog(): void {
    const dialogRef = this.dialog.open(SelectAnalystUploadComponent, {
      width: '400px',
      panelClass: 'assign-dialog-container',
      autoFocus: false,
      data: { 
        tableData: [],
        assignedAnalyst: this.assignedAnalyst,
        selected: !!this.selectedAnalystId
      }
    });

    dialogRef.componentInstance.analystAssigned.subscribe((analystData: any) => {
      this.assignedAnalyst = analystData.name;
      this.selectedAnalystId = analystData.id;
    });

    this.dataService.selectAnalyst().subscribe(
      (response: any[]) => {
        dialogRef.componentInstance.tableData = response.map(item => ({
          column1: item.colleague_fullname,
          column2: 'Value 1',
          column3: 'Data 1',
          selected: false,
          colleague_id: item.colleague_id
        }));
      },
      error => {
        console.error('Select Analyst API error:', error);
      }
    );
  }

  onSubmit() {
    const payload = {
      // ... your existing payload fields ...
      colleague_id: this.selectedAnalystId
    };

    this.dataService.submitLoanData(payload).subscribe(
      response => {
        console.log('API response:', response);
      },
      error => {
        console.error('API error:', error);
      }
    );
  }

  // ... other code ...
}


